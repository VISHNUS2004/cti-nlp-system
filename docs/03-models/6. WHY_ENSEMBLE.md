# Why We Used an Ensemble Model in the CTI-NLP Project

## Introduction

In our **AI-Based Predictive Cyber Threat Intelligence System**, one of the core tasks is **Threat Type Classification** — predicting whether a given piece of threat intelligence text refers to **phishing, malware, APTs, ransomware**, or other categories.

Originally, this classification was performed using a **single machine learning model**. However, after experimenting and analyzing results, we decided to switch to an **ensemble model** that combines **XGBoost** and **Logistic Regression**.

This document explains **why** we made this decision and **how** it benefits the project.

## Limitations of a Single Model

While a single model is simpler to train and maintain, it comes with **drawbacks**:

- **Overfitting risk** — Model may adapt too much to training data quirks.
- **Bias towards certain patterns** — E.g., some models handle keyword-based features well, others excel at complex patterns.
- **Poor adaptability** — A single model might fail on unusual or rare threat descriptions.

---

## Strengths of the Models We Chose

### XGBoost

- Excellent at handling **non-linear patterns**.
- Works well with structured **TF-IDF features**.
- Often achieves high accuracy in real-world competitions.
- Robust to missing or noisy features.

### Logistic Regression

- **Fast and interpretable** — Can show which keywords influence predictions.
- Works very well on **high-dimensional sparse data** (like n-grams).
- Lower risk of overfitting on small datasets.

---

## Why an Ensemble is Better

An **ensemble model** combines multiple classifiers to make a final decision.  
We chose a **soft-voting ensemble** that averages prediction probabilities from both models.

Benefits:

- **Reduced variance** → Less sensitive to dataset noise.
- **Reduced bias** → Balances out the weaknesses of each model.
- **Better generalization** → More accurate on unseen data.

Example:

| Input Threat Text                                                | Logistic Regression Prediction | XGBoost Prediction | Ensemble Final Prediction |
| ---------------------------------------------------------------- | ------------------------------ | ------------------ | ------------------------- |
| "APT29 targeting government agencies with spear-phishing emails" | Phishing (Correct)             | APT (Incorrect)    | **Phishing (Correct)**    |

---

## Expected Impact on the Project

By adopting an ensemble, we expect:

- **Higher accuracy** in threat type classification.
- **Better robustness** against ambiguous or short texts.
- **Improved adaptability** for different cyber threat datasets.

This directly enhances our system's capability to assist analysts in **quickly identifying** threat categories with higher confidence.

## Conclusion

Using an **XGBoost + Logistic Regression Ensemble** is a strategic decision for our CTI-NLP system.  
It improves prediction performance, reduces misclassifications, and increases system reliability — all critical for real-world cybersecurity operations.
